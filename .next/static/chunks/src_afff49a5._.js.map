{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///project/sandbox/user-workspace/src/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useState, ReactNode, useEffect } from \"react\";\nimport axios from \"axios\";\n\ninterface AuthContextType {\n  user: { id: number; username: string; role: \"admin\" | \"user\" } | null;\n  login: (username: string, password: string) => Promise<boolean>;\n  logout: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<AuthContextType[\"user\"]>(null);\n\n  useEffect(() => {\n    // On mount, check if session cookie exists and fetch user info if needed\n    async function fetchSession() {\n      try {\n        const res = await axios.get(\"/api/auth/session\");\n        if (res.data.user) {\n          setUser(res.data.user);\n        }\n      } catch {\n        setUser(null);\n      }\n    }\n    fetchSession();\n  }, []);\n\n  const login = async (username: string, password: string) => {\n    try {\n      const res = await axios.post(\"/api/auth/login\", { username, password });\n      if (res.data.role) {\n        setUser({ id: 0, username, role: res.data.role }); // id can be fetched if needed\n        return true;\n      }\n      return false;\n    } catch {\n      return false;\n    }\n  };\n\n  const logout = async () => {\n    try {\n      await axios.post(\"/api/auth/logout\");\n      setUser(null);\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAWA,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAA+B;AAExD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAA2B;IAE1D,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,yEAAyE;YACzE,eAAe;gBACb,IAAI;oBACF,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;oBAC5B,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE;wBACjB,QAAQ,IAAI,IAAI,CAAC,IAAI;oBACvB;gBACF,EAAE,OAAM;oBACN,QAAQ;gBACV;YACF;YACA;QACF;iCAAG,EAAE;IAEL,MAAM,QAAQ,OAAO,UAAkB;QACrC,IAAI;YACF,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC,mBAAmB;gBAAE;gBAAU;YAAS;YACrE,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE;gBACjB,QAAQ;oBAAE,IAAI;oBAAG;oBAAU,MAAM,IAAI,IAAI,CAAC,IAAI;gBAAC,IAAI,8BAA8B;gBACjF,OAAO;YACT;YACA,OAAO;QACT,EAAE,OAAM;YACN,OAAO;QACT;IACF;IAEA,MAAM,SAAS;QACb,IAAI;YACF,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC;YACjB,QAAQ;QACV,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iBAAiB;QACjC;IACF;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAO;QAAO;kBAChD;;;;;;AAGP;GA7Ca;KAAA;AA+CN,MAAM,UAAU;;IACrB,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANa","debugId":null}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///project/sandbox/user-workspace/src/components/NavBar.tsx"],"sourcesContent":["\"use client\";\n\n\"use client\";\n\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { useAuth } from '../context/AuthContext';\n\nexport default function NavBar() {\n  const router = useRouter();\n  const { user, logout } = useAuth();\n\n  const handleLogout = async () => {\n    try {\n      await logout();\n      router.push('/auth/login');\n    } catch (error) {\n      console.error('Error al cerrar sesión:', error);\n    }\n  };\n\n  return (\n    <nav className=\"navbar navbar-expand-lg navbar-light bg-white shadow-sm\">\n      <div className=\"container\">\n        <Link \n          href=\"/inicio\"\n          className=\"navbar-brand fw-bold\"\n        >\n          Juegos de Mesa\n        </Link>\n\n        <div className=\"d-flex align-items-center\">\n          {user?.role === 'admin' && (\n            <>\n              <Link\n                href=\"/products\"\n                className=\"nav-link px-3\"\n              >\n                Gestionar Juegos\n              </Link>\n              <Link\n                href=\"/products/new\"\n                className=\"nav-link px-3\"\n              >\n                Agregar Juego\n              </Link>\n              <button\n                onClick={handleLogout}\n                className=\"btn btn-danger ms-3\"\n              >\n                Cerrar Sesión\n              </button>\n            </>\n          )}\n          {user?.role === 'user' && (\n            <>\n              <Link\n                href=\"/cart\"\n                className=\"nav-link px-3\"\n              >\n                Ver Carrito\n              </Link>\n              <button\n                onClick={handleLogout}\n                className=\"btn btn-danger ms-3\"\n              >\n                Cerrar Sesión\n              </button>\n            </>\n          )}\n          {!user && (\n            <div className=\"d-flex align-items-center\">\n              <Link\n                href=\"/catalogo\"\n                className=\"nav-link px-3\"\n              >\n                Catálogo\n              </Link>\n              <Link\n                href=\"/auth/login\"\n                className=\"btn btn-primary ms-3\"\n              >\n                Iniciar Sesión\n              </Link>\n            </div>\n          )}\n        </div>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;AAIA;AACA;AACA;;;AANA;AAEA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAE/B,MAAM,eAAe;QACnB,IAAI;YACF,MAAM;YACN,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,+JAAA,CAAA,UAAI;oBACH,MAAK;oBACL,WAAU;8BACX;;;;;;8BAID,6LAAC;oBAAI,WAAU;;wBACZ,MAAM,SAAS,yBACd;;8CACE,6LAAC,+JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;8CAGD,6LAAC,+JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;;;wBAKJ,MAAM,SAAS,wBACd;;8CACE,6LAAC,+JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;;;wBAKJ,CAAC,sBACA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;8CAGD,6LAAC,+JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf;GAlFwB;;QACP,qIAAA,CAAA,YAAS;QACC,iIAAA,CAAA,UAAO;;;KAFV","debugId":null}}]
}